<!DOCTYPE html>
<html>
  <head>
    <title>公式编辑器</title>
    <meta charset="UTF-8" />
    <meta name="renderer" content="webkit" />
    <style>
      html,
      body {
        width: 100%;
        height: 100%;
        padding: 0;
        margin: 0;
      }

    </style>
    <!-- 开发环境配置 -->
    <script src="dist/npmBundle.js"></script>
    <script src="dev-lib/jquery-1.11.0.min.js"></script>
    <script src="dev-lib/kitygraph.all.js"></script>
    <script src="dev-lib/kity-formula-render.all.js"></script>
    <script src="dev-lib/kity-formula-parser.all.min.js"></script>
    <script src="dev-lib/dev-define.js"></script>
    <script>
      inc.config({
        base: './src',
      });
    </script>
    <script src="dev-lib/exports.js"></script>
    <script src="dev-lib/start.js"></script>
    <script src="dev-lib/dev-start.js"></script>
    <!-- end -->
    <!-- 生产环境配置 -->
    <!-- <script src="dist/npmBundle.js"></script>
    <script src="dist/jquery-1.11.0.min.js"></script>
    <script src="dist/kitygraph.all.min.js"></script>
    <script src="dist/kity-formula-render.all.min.js"></script>
    <script src="dist/kity-formula-parser.all.min.js"></script>
    <script src="dist/kityformula-editor.all.min.js"></script> -->
    <!-- end -->
    <script>
      jQuery(function ($) {
        const device = /device=(android|pc)/.exec(location.search);
        const protocol = /protocol=(webview|iframe|documentEvent)/.exec(location.search);
        if (!device) {
          console.log('没有读取到设备类型');
        } else {
          console.log('读取到当前设备类型为：', device[1]);
        }
        if (!protocol) {
          console.log('没有读取到设备类型');
        } else {
          console.log('读取到当前协议类型为：', protocol[1]);
        }
        var factory = kf.EditorFactory.create($('#kfEditorContainer')[0], {
          render: {
            fontsize:
              device && device[1] === 'pc'
                ? 30
                : (window.innerWidth / 1920).toFixed(3) * 50,
          },
          ui: {
            device: device ? device[1] : 'android',
            scale:
              device && device[1] === 'pc' ? 1 : (window.innerWidth / 1920).toFixed(3),
            protocol: protocol ? protocol[1] : 'webview',
          },
          resource: {
            path: 'resource/',
          },
        });

        factory.ready(function (KFEditor) {
          // this指向KFEditor

          this.execCommand('render', '\\placeholder');
          this.execCommand('focus');
          this.execCommand('ready');

          document.getElementById('kfEditorContainer').style.visibility = 'visible';
          document.getElementById('kf-loading').style.visibility = 'hidden';
          window.kfe = this;
        });
      });
    </script>
    <link rel="stylesheet" href="dist/index.min.css" />
  </head>
  <body>
    <div id="kfEditorContainer" class="kf-editor" style="visibility: hidden;"></div>
    <div id="kf-loading" class="kf-loading">加载中...</div>
  </body>
</html>
